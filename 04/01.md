# 1. 비동기 프로그래밍의 어려움

- JavaScript에선 비동기 코드에 대한 제어를 놓치는 일이 흔하다.
- 클로저와 익명함수 정의는 코드베이스 지점을 옮겨다니지 않게 해줘 도움이 된다.

## 1.1 간단한 웹 스파이더 만들기

- 웹 URL을 입력 받아 해당 URL의 내용을 로컬 파일로 다운 받는 간단한 콘솔용 앱을 만든다.
- 다음 npm 종속성이 사용된다.
    - superagent: 스트림라인 HTTP 호출 라이브러리
    - mkdirp: 재귀적으로 디렉터리를 만드는 작은 유틸리티
- 위는 [공식 레포지터리](https://github.com/PacktPublishing/Node.js-Design-Patterns-Third-Edition)에 있다.
- 레포지터리를 확인하여 `spider.js`, `spider-cli.js`를 만든다.
- 이제 앱을 실행해볼 수 있다.

```zsh
$ npm install
$ npm spider-cli.js http://www.example.com
```

- 이제 위 코드를 점점 개선해나간다.

## 1.2 콜백 지옥(Callback hell)

- spider() 함수는 간단하지만 읽기 쉽지 않다.
- 많은 클로저와 in-place 콜백 정의가 코드 가독성을 떨어뜨리는 상황을 콜백 지옥이라 한다.
- Node.js나 JavaScript에서 가장 잘 알려진 안티 패턴 중 하나다.
- 또 다른 문제는 각 스코프에서 사용되는 변수이름이 중복된다는 것이다. (e.g. err)
- 그리고 클로저는 성능 및 메모리 소비에 부정적인 영향을 미칠 수 있다.

-----
[HOME](./index.md)
